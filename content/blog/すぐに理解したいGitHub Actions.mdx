---
date: 2021-05-14T22:44:38.000+00:00
title: ã™ãã«ç†è§£ã—ãŸã„GitHub Actions
thumbnail: https://i2.wp.com/www.mushroom-blog.com/wp-content/uploads/2021/05/GithubActions%E3%81%AE%E4%B8%96%E7%95%8C-1.png?zoom=2&resize=360%2C238&ssl=1
tag:
  - ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰
---

# ã™ãã«ç†è§£ã—ãŸã„ GitHub Actions

<br />

Jenkins ãŠã˜ã•ã‚“ã®æŸç¸›ã‹ã‚‰è§£æ”¾ã•ã‚Œã¦ã‚ˆã†ã‚„ãã€ç§ã® CI/CD å‘¨ã‚Šã«ã‚‚æ˜¥ãŒè¨ªã‚Œã¾ã—ãŸã€‚Github Actions ã¸çŸ¥è­˜ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã™ ğŸ‰
ã¨ã„ã†ã‚ã‘ã§ã€ã“ã®è¨˜äº‹ã§ã¯ GitHub Actions ã®è¨­å®šå‘¨ã‚Šã«ã¤ã„ã¦ã¡ã‚ƒã‚“ã¨çŸ¥ã£ã¦ãŠã“ã†ã¨ã„ã†ã“ã¨ã§ã€æ‰‹çŸ­ã«ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚
ã‚‚ã¡ã‚ã‚“ GitHub ãŒç”¨æ„ã—ã¦ã„ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã—ã¦ãŠã‚Šã¾ã™ã€‚

> [GitHub Actions ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - GitHub Docs](https://docs.github.com/ja/actions)

<br />

## GitHub Actions ã®å…¨ä½“åƒ

![d3481cd1.png](attachments/d3481cd1.png)

å…¬å¼ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ç”»åƒã ã¨å°‘ã—åˆ†ã‹ã‚Šã¥ã‚‰ã„æ°—ãŒã—ãŸã®ã§ã€ã¡ã‚‡ã£ã¨è‡ªåˆ†ã§æã„ã¦ã¿ã¾ã—ãŸã€‚

ç°¡å˜ã«èª¬æ˜ã™ã‚‹ã¨ã€

1. WebHook ã«ã‚ˆã‚‹ã€Œã‚¤ãƒ™ãƒ³ãƒˆã€ãŒãƒˆãƒªã‚¬ãƒ¼ã¨ãªã£ã¦(æ‰‹å‹•å®Ÿè¡Œã‚„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œã‚‚å¯)ã€ãƒªãƒã‚¸ãƒˆãƒªã®`.github/workflows`ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã‚ã‚‹ã€Œãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€ãŒç™ºç”Ÿã—ã¾ã™ã€‚
2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ã€Œã‚¸ãƒ§ãƒ–ã€ã¨ã„ã†å˜ä½ã«åˆ†ã‹ã‚Œã¦ã€**åŸºæœ¬çš„ã«ã‚¸ãƒ§ãƒ–ã¯ä¸¦è¡Œã§å®Ÿè¡Œ**ã•ã‚Œã¾ã™ã€‚ã“ã®æ™‚ã€ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ç’°å¢ƒã‚’ã€Œãƒ©ãƒ³ãƒŠãƒ¼ã€ã¨èª­ã‚“ã§ã„ã¾ã™ã€‚ãƒ©ãƒ³ãƒŠãƒ¼ã¯æ­£ç¢ºã«ã¯ GitHub ãŒç”¨æ„ã—ã¦ãã‚Œã¦ã„ã‚‹ä»®æƒ³ç’°å¢ƒã§ã€[ãƒ©ãƒ³ãƒŠãƒ¼ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/actions/runner)ã‚‚å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã®ã§è‡ªå‰ã§ã‚‚ç”¨æ„ã§ãã¾ã™ã€‚
3. ã‚¸ãƒ§ãƒ–ã¯ã€Œã‚¹ãƒ†ãƒƒãƒ—ã€ã¨ã„ã†å˜ä½ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚
4. **ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã¾ãŸã¯ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰**ã‚’æŒ‡ã—ã¾ã™ã€‚

### ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®šç¾©

ã‚ˆãä½¿ã†ã‚ˆã†ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯[å…¬å¼ã®ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ãƒ¼ã‚¹](https://github.com/marketplace)ã«å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚yaml ãƒ•ã‚¡ã‚¤ãƒ«ã«`use`ã‚’å®šç¾©ã—ã¦ãã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚  
ã“ã“ã«å¥½ã¿ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒãªã‘ã‚Œã°ã€ã‚«ã‚¹ã‚¿ãƒ ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å®šç¾©æ–¹æ³•ã¯ï¼“ç¨®é¡ã§ã™ã€‚

- [Dockerfile ã§ã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–ã—ã¦å®šç¾©ã™ã‚‹](https://docs.github.com/ja/actions/creating-actions/creating-a-docker-container-action)
- [Javascript ã§å®šç¾©ã™ã‚‹](https://docs.github.com/ja/actions/creating-actions/creating-a-javascript-action)
- [ShellScript ã§å®šç¾©ã™ã‚‹](https://docs.github.com/ja/actions/creating-actions/creating-a-composite-run-steps-action)(ã€Œè¤‡åˆå®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å‘¼ã‚“ã§ã„ã‚‹)

### ä¾å­˜ã™ã‚‹ã‚¸ãƒ§ãƒ–

ã‚¸ãƒ§ãƒ–ã¯åŸºæœ¬çš„ã«ä¸¦è¡Œã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ã§ã€ã‚¸ãƒ§ãƒ– A ãŒå®Ÿè¡Œã•ã‚Œã¦ã‹ã‚‰ã‚¸ãƒ§ãƒ– B ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã„å ´åˆã¯ã€yaml ãƒ•ã‚¡ã‚¤ãƒ«ã«`needs`ã‚’å®šç¾©ã—ã¦é †åºã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚

```yaml
jobs:
  setup:
    runs-on: ubuntu-latest
    steps:
      - run: ./setup_server.sh
  build:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - run: ./build_server.sh
  test:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - run: ./test_server.sh
```

### ç’°å¢ƒå¤‰æ•°ã¨ã‹ãƒ‡ãƒ¼ã‚¿ã®æ ¼ç´ã¨ã‹

ã‚«ã‚¹ã‚¿ãƒ ã§ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹å ´åˆã¯`env`ã‚’å®šç¾©ã—ã¦ãŠã‘ã°å®Ÿè¡Œæ™‚ã«å‚ç…§ã—ã¦ãã‚Œã¾ã™ã€‚[ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç’°å¢ƒå¤‰æ•°](https://docs.github.com/ja/actions/reference/environment-variables#default-environment-variables)ã¨ã—ã¦ã„ãã¤ã‹ã¯ GitHub Actions ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

```yaml
jobs:
  example-job:
    steps:
      - name: Connect to PostgreSQL
        run: node client.js
        env:
          POSTGRES_HOST: postgres
          POSTGRES_PORT: 5432
```

ä»–ã«ã‚‚ãƒ­ã‚°ã®å‡ºåŠ›ã‚„ãƒ“ãƒ«ãƒ‰ã—ãŸãƒšãƒ¼ã‚¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©ã¯ã€`with`ã‚’å®šç¾©ã—ã¦æˆæœç‰©ã‚’æ ¼ç´ã§ãã¾ã™

```yaml
jobs:
  example-job:
    steps:
      - name: Build App
        run: npm run build
        env:
          URL_PREFIX: gh-actions-test

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: dist
```

> #### GITHUB_TOKEN
>
> GITHUB_TOKEN ã¨ã¯ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§å„ã‚¸ãƒ§ãƒ–ãŒé–‹å§‹ã•ã‚Œã¦ã‹ã‚‰çµ‚äº†ã™ã‚‹ã¾ã§æœ‰åŠ¹ãªãƒªãƒã‚¸ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒ‡ã—ã¾ã™ã€‚
> ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒãƒªãƒã‚¸ãƒˆãƒªã‚’æ“ä½œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

## å®šç¾©ã—ãŸ YAML ãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®

åŸºæœ¬çš„ã«ã¯`.github/workflows`ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦ã€ãã®ä¸­ã«å„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã® YAML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãŠãã¾ã™ã€‚  
ãŸã¨ãˆã°ã€ç§ã®å ´åˆã¯ã€æœ¬ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‹•ãé–‹ç™ºç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ç”¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼`deploy_dev.yml`ã¨ã€PullRequest ãŒä½œæˆã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚„ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼`pull_request_analysis.yml`ã‚’`.github/workflow`ã«é…ç½®ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

```sh
.github
â””â”€â”€ workflows
    â”œâ”€â”€ deploy_dev.yml
    â””â”€â”€ pull_request_analysis.yml
```

ã“ã†ã—ã¦ãŠãã“ã¨ã§ã€GitHub ä¸Šã®ãƒªãƒã‚¸ãƒˆãƒªç”»é¢ã§ Actions ã‚¿ãƒ–ã‹ã‚‰ï¼’ã¤ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚

å„è¨€èªã‚„å®Ÿè¡Œç’°å¢ƒã«å¿œã˜ã¦[ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ç”¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](https://github.com/actions/starter-workflows/tree/055373ee0b531de9b779896c520d0555e7df48ae)ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ç”»é¢ä¸Šã‹ã‚‰ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã™ã‚‹ã¨ã“ã‚Œã‚‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã€YAML ã‚’æ›¸ã‹ãšã¨ã‚‚ç°¡å˜ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ãã¾ã™ã€‚YAML ã‚’æ›¸ãå ´åˆã‚‚ã“ã‚Œã‚‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® YAML ã‚’å‚è€ƒã«ã™ã‚‹ã¨ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

## YAML ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãæ–¹

ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§å¤šãã¯äº‹è¶³ã‚Šã¾ã™ã€‚
â†“YAML ã‚’èª­ã¿æ›¸ãã—ã¦ã‚ã‹ã‚‰ãªã„å ´åˆã¯ã“ã¡ã‚‰ã‹ã‚‰ã€‚

> [Actions Cheat Sheet](https://github.github.io/actions-cheat-sheet/actions-cheat-sheet.pdf) > [GitHub Actions ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹æ–‡ - GitHub Docs](https://docs.github.com/ja/actions/reference/workflow-syntax-for-github-actions)

<br />
<br />
<br />
<br />
<br />
  
æ¯åº¦CI/CDã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚„ã‚‰ä¿®æ­£ã‚’ã—ãŸã‚Šã€ã‚³ãƒ¼ãƒ‰æ›¸ãã®ã«é›†ä¸­ã§ããªã„ã®ã¯é¢å€’ã ãªã¨æ€ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€GithubActionsã§ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†ã¨ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã¦ã„ã‚‹ã¨ã‚„ã£ã±ã‚Šå®‰å®šæ„Ÿã‚’æ„Ÿã˜ã¾ã™ã€‚ã“ã‚Œã‹ã‚‰ç©æ¥µçš„ã«ä½¿ç”¨ã—ã¦ã€ã•ã‚‰ã«çŸ¥è¦‹ã‚’æ·±ã‚ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚

<br />
<br />
